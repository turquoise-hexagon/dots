#!/bin/sh
#
# volume - volume control

readonly SINK=$(pactl get-default-sink)

die() {
    printf '%s\n' "${1:-usage : ${0##*/} <offset|toggle>}" >&2

    exit 1
}

# basic argument parsing
case $* in
    [+-][0-9]%)          ;;
    [+-][0-9][0-9]%)     ;;
    [+-][0-9][0-9][0-9]%);;
    toggle)
        pactl set-sink-mute "$SINK" toggle
        exit
        ;;
    *)
        die
esac

pactl set-sink-volume "$SINK" "$*"

# send notification when fullscreen
bspc query -N -n focused.fullscreen > /dev/null &&
    # get volume
    pactl get-sink-volume "$SINK" | {
        read -r _ _ _ _ volume _

        dunstify -r 501 "Volume : $volume"
    }

: # fix exit status
